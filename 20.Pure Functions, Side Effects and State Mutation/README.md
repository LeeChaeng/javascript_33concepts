# Pure Functions, Side Effects and State Mutation

- 20th concept of 33

## 함수란 무엇인가?

함수는 **인자(arguments)**라 불리는 것을 입력 값으로 받고 반환 값(return value)이라 불리는 결과물을 생성해낸다. 함수는 다음 목적을 위해 사용될 수 있다.

- **Mapping** : 주어진 입력 값을 기반으로 어떠한 출력 값을 생성해낸다. 말 그대로 어떠한 입력 값을 출력 값으로 맵핑해준다.
- **Procedures** : 함수는 어떠한 일련의 과정을 수행하기 위해서 호출될 수 있다. 이 과정이 일반적으로 프로시져라고 알려져있다. 그리고 이러한 스타일로 작성하는 프로그래밍은 **프로시져형 프로그래밍(procedural programming)**으로 알려져있다.
- **I/O** : 시스템의 다른 부분과 통신하기 위해서 존재하는 함수들이다. 이를테면 화면, 저장소, 시스템 로그, 네트워크 등이 있다.

## 맵핑

순수 함수는 맵핑에 관한 것이다. 함수는 입력 인자 값을 반환 값으로 맵핑한다. 이 말은 어떠한 입력 값이 있다면 출력 값이 존재한다는 것이다. 한 함수는 입력 값을 받고 그에 상응하는 출력 값을 내보낸다.

`Math.max()` 함수는 인자 값으로 숫자들을 받고 가장 큰 숫자를 반환한다.

```js
Math.max(2, 8, 5); //8
```

이 예제에서는 `2`, `8`, `5`가 입력 값으로 들어왔다. 이 값들이 함수로 넘어가는 값이다.

`Math.max()`는 함수이다. 그리고 어떤 숫자들을 입력 값으로 받아서 가장 큰 값을 반환해준다. 위 경우에는 입력 값 중 가장 큰 숫자는 `8`이었다. 그리고 `8`이 반환됐다.

`f(x) = 2x`가 있다. 이를 `f(2)`를 `4` 대신 쓸 수 있다.

```js
const double = x => x * 2;
console.log(double(5)); // 10
```

- 자바스크립트 버전의 함수로 변환한 결과이다.
- `double(5)`는 `10`이라는 숫자로 대체할 수 있다. 왜냐면 `double()`은 순수 함수이기 때문이다.
- 하지만 만일, `double()` 함수가 디스크에 값을 저장하거나 콘솔에 로깅하거나 하는 side-effect를 갖고 있다면 의미를 변경하지 않고 단순히 `double(5)`를 `10`으로 대체할 수 없다.

## 순수 함수

순수 함수는 다음의 특성을 지닌 함수이다.

- 같은 입력을 받았을 때, 같은 출력을 반환한다.
- side-effect를 갖지 않는다.

**_함수가 순수하지 않다는 것의 명백한 증거는 그 함수가 반환 값을 사용하지 않으면서도 호출했을 때 올바른 동작이 가능한지에 달렸다. 순수 함수는 반환 값을 사용하지 않으면서는 올바른 동작을 할 수 없다._**

실제로 순수 함수를 이용하여 구현할 수 있는 프로그램 요구사항이라면 다른 옵션을 선택하기 보다는 순수 함수를 사용하는 것을 권장한다. 순수 함수는 어떤 입력 값을 받고 그 입력 값을 기반으로 출력 값을 반환한다. 순수 함수는 프로그램 안에서 가장 간단한 재사용 가능한 빌딩 블록이다.

순수함수는 이익이 되는 속성들을 많이 갖고 있다. 그리고 함수형 프로그래밍의 기반을 형성한다. 순수 함수는 바깥 상태로부터 완벽히 독립적이다 그리고 공유된 변화하는 상태들에 관련된 클래스의 버그로부터 완전히 면역(immune)이다.

## 공유되는 상태의 문제점

## 같은 입력값이 들어왔을 때, 항상 같은 출력이 나온다.

```js
Math.random(); // => 0.4011148700956255
Math.random(); // => 0.8533405303023756
Math.random(); // => 0.3550692005082965
```

함수를 호출할 때 우리가 아무런 인자를 넘기지 않았음에도 불구하고 이 함수들은 각각 다른 출력 값을 만들어낸다. 이 사실이 의미하는 바는 `Math.random()` **함수는 순수하지 않다는 것이다.**

## 순수 함수는 어떠한 side-effect도 만들지 않는다.

순수 함수는 어떠한 side-effect도 만들지 않는다. 즉, 순수 함수는 어떤 외부 상태도 변환하지 않는다는 것을 의미한다.

## 불변성

자바스크립트의 오브젝트는 레퍼런스들이다. 이 의미는 만일 함수나 오브젝트나 배열 파라미터에 변화를 가하면, 함수 밖의 접근 가능한 상태를 변화시킨다는 이야기이다. 순수 함수는 외부 상태를 변화시켜서는 안된다.
